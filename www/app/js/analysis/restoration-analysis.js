define(["root/analysis/restoration-charts","root/analysis/compute-histogram","root/analysis/analysisConfig","root/analysis/ethiopiaConfig","root/analysis/constants","dojo/promise/all","dojo/dom-class"],function(s,a,t,o,n,e,r){var i=function(s){return 0===s.length?s:s[0].counts.slice(1)},l=function(s,a){if(s.length===a)return s;for(var t=[],o=0;a>o;o++)t[o]=s[o]||0;return t},m=function(s,a){return s.map(function(s,t){return{name:a[t],data:[s]}}).filter(function(s){return 0!==s.data[0]&&"No Data"!==s.name})};return{performRestorationAnalysis:function(E,O){var R,c,h,C,g=o.options[O],u=E.geometry,_=g.id,L={},P=t[n.SLOPE],A=t[n.LAND_COVER],T=t[n.POPULATION],d=t[n.TREE_COVER];L[n.SLOPE]=a.multiplyRasters(P.id,_,u),L[n.LAND_COVER]=a.multiplyRasters(A.id,_,u),L[n.POPULATION]=a.multiplyRasters(T,_,u),L[n.TREE_COVER]=a.multiplyRasters(d.id,_,u),e(L).then(function(a){r.add("analysis-loader","hidden"),s.prepareContainer(g.name),R=l(i(a[n.SLOPE].histograms),P.classes.length),c=l(i(a[n.LAND_COVER].histograms),A.classes.length),h=l(i(a[n.POPULATION].histograms),T.classes.length),C=l(i(a[n.TREE_COVER].histograms),d.classes.length),R=m(R,P.classes),c=m(c,A.classes),h=m(h,T.classes),C=m(C,d.classes),s.makeChart(n.SLOPE_CHART_ID,P.name,R),s.makeChart(n.LAND_COVER_CHART_ID,A.name,c),s.makeChart(n.POPULATION_CHART_ID,T.name,h),s.makeChart(n.TREE_COVER_CHART_ID,d.name,C),console.log(n.SLOPE,a[n.SLOPE].histograms),console.log(n.LAND_COVER,a[n.LAND_COVER].histograms),console.log(n.POPULATION,a[n.POPULATION].histograms),console.log(n.TREE_COVER,a[n.TREE_COVER].histograms)})}}});