define(["declare","mainmodel","ko","dom","topic","toolsconfig","memory","number","array","root/languages","query","attr","toolsevents","root/analysis/constants","root/analysis/analysisConfig"],function(e,a,o,s,t,r,l,n,b,i,v,u,m,p,c){var d=e(null,{constructor:function(e,s){r.getConfig();d._vm={},d._dataModel={},require(["toolsevents"],function(e){var s=a.getVM(),r=s.currentLanguage(),l=app.config.appLanguages[r].title,n=app.config.appLanguages[r].flagTitle,b=i[r],v=e.getEvents();d._vm.tabBasemapTitle=o.observable(b.tabBasemapTitle),d._vm.tabLegendTitle=o.observable(b.tabLegendTitle),d._vm.tabLayersTitle=o.observable(b.tabLayersTitle),d._vm.buttonLayersText=o.observable(b.buttonLayersText),d._vm.closeButtonText=o.observable(b.closeButtonText),d._vm.title=o.observable(l),d._vm.flagTitle=o.observable(n),d._vm.printDialog=o.observable(b.printDialog),d._vm.layersDrawingOption=o.observable([]),d._vm.about=o.observable(b.about),d._vm.downloadData=o.observable(b.downloadData),d._vm.sources=o.observable(b.sources),d._vm.print=o.observable(b.print),d._vm.legislativeText=o.observable(b.legislativeText),d._vm.printReport=o.observable(b.printReport),d._vm.clickPrintReport=function(e,a){t.publish(v.printReport,e,a)},d._vm.zoom=o.observable(b.zoom),d._vm.selectAll=o.observable(b.selectAll),d._vm.clearAll=o.observable(b.clearAll),d._vm.transparency=o.observable(b.transparency),d._vm.basemapTitles=o.observable(b.basemapTitles),d._vm.editingEnabled=o.observable(!1),d._vm.editingFeatureEnabled=o.observable(!1),d._vm.addFeatureEnabled=o.observable(!1),d._vm.currentLayerId=o.observable(""),d._vm.currentEditableGraphic=o.observable({}),d._vm.originalEditableGraphic=o.observable({}),d._vm.aboutLink=o.observable(app.config.aboutLinkUrl),d._vm.downloadLink=o.observable(app.config.downloadDataUrl),d._vm.mapThemes=o.observableArray("en"===r?app.config.mapThemes:app.config.mapThemesAlternate),d._vm.showMapThemes=o.observable(!1),d._vm.mapThemesLabel=o.observable(b.mapThemesLabel),d._vm.basemapGalleryVisible=o.observable(!1),d._vm.analyzeToolsVisible=o.observable(!1),d._vm.shareToolsVisible=o.observable(!1),d._vm.showUploadTools=o.observable(!1),d._vm.restorationModuleType=o.observable("restoration"),d._vm.slopeAmountOptions=o.observableArray(c[p.SLOPE_BREAKDOWN].slopeOptions),d._vm.slopeSelectDescription=o.observable("Choose slope percent:"),d._vm.restorationModuleChartTitlePrefix=o.observable("Potential for "),d._vm.slopeAnalysisRestorationOptionPrefix=o.observable("Option "),d._vm.slopeActiveOption=o.observable(c[p.SLOPE_BREAKDOWN].slopeOptions[0]),d._vm.restorationModule=o.observable(app.config.restorationModule),d._vm.restorationModuleOptions=o.observableArray(app.config.restorationModuleOptions),d._vm.forestLossYears=o.observableArray(["2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013"]),d._vm.clearanceAlertBounds=o.observable(),d._vm.clearanceAlertLabels=o.observable(),d._vm.popupDataTab=o.observable(b.popupDataTab),d._vm.popupAnalysisTab=o.observable(b.popupAnalysisTab),d._vm.popupDocumentTab=o.observable(b.popupDocumentTab),d._vm.popupActiveTab=o.observable("popupDataTab"),d._vm.popupIndex=o.observable(0),d._vm.popupCount=o.observable(0),d._vm.analysisLoss=o.observable(b.analysisLoss),d._vm.analysisLC=o.observable(b.analysisLC),d._vm.analysisGain=o.observable(b.analysisGain),d._vm.analysisIFL=o.observable(b.analysisIFL),d._vm.analysisCS=o.observable(b.analysisCS),d._vm.analysisFire=o.observable(b.analysisFire),d._vm.analysisLCComposition=o.observable(b.analysisLCComposition),d._vm.analysisOptions=o.observableArray(b.analysisOptions),d._vm.firesOneWeek=o.observable(b.firesOneWeek),d._vm.fires72Hours=o.observable(b.fires72Hours),d._vm.fires48Hours=o.observable(b.fires48Hours),d._vm.fires24Hours=o.observable(b.fires24Hours),d._vm.lossStartingYear=o.observable(b.lossStartingYear),d._vm.lossEndingYear=o.observable(b.lossEndingYear),d._vm.accordionForestCoverTitle=o.observable(b.accordionForestCoverTitle),d._vm.accordionForestLossTitle=o.observable(b.accordionForestLossTitle),d._vm.accordionLandUseTitle=o.observable(b.accordionLandUseTitle),d._vm.treeCoverAnalysis=o.observable(b.treeCoverAnalysis),d._vm.otherAnalysisTypes=o.observable(b.otherAnalysisTypes),d._vm.forestCoverLossLabel=o.observable(b.forestCoverLossLabel),d._vm.activeFiresLabel=o.observable(b.activeFiresLabel),d._vm.treeCoverDensityLabel=o.observable(b.treeCoverDensityLabel),d._vm.landCoverLabel=o.observable(b.landCoverLabel),d._vm.treeCoverGainLabel=o.observable(b.treeCoverGainLabel),d._vm.carbonLayerLabel=o.observable(b.carbonLayerLabel),d._vm.intactForestLayerLabel=o.observable(b.intactForestLayerLabel),d._vm.uploadInstructions=o.observableArray(b.uploadInstructions),d._vm.drawButtonText=o.observable(b.drawButtonText),d._vm.uploadButtonText=o.observable(b.uploadButtonText),d._vm.currentAnalysisType=o.observable(b.analysisLoss),d._vm.clearAllFeatures=o.observable(b.clearAllFeatures),d._vm.deleteCustomFeature=o.observable(b.deleteCustomFeature),d._vm.landsatTextLabel=o.observable(b.landsatTextLabel),d._vm.tcdSelectorBegin=o.observable(b.tcdSelectorBegin),d._vm.tcdSelectorEnd=o.observable(b.tcdSelectorEnd),d._vm.treeCoverSliderLabel=o.observable(b.treeCoverSliderLabel),d._vm.tcdSelectorValue=o.observable(30),d._vm.landsatOptions=o.observableArray([2013,2012,2011,2010,2009,2008,2007,2006,2005,2004,2003,2002,2001,2e3]),d._vm.selectedLandsatYear=o.observable(2013),d._vm.customFeatureShowing=o.observable(!1),d._vm.featureDocuments=o.observableArray([]),d._vm.documentsUnavailable=o.observable(b.documentsUnavailable),d._vm.documentType=o.observable(b.documentType),d._vm.documentAuthor=o.observable(b.documentAuthor),d._vm.documentDate=o.observable(b.documentDate),d._vm.documentLink=o.observable(b.documentLink),d._vm.changePopupTabs=function(e,a){var o=a.target?a.target:a.srcElement;e.popupActiveTab(o.id),"popupAnalysisTab"===o.id?t.publish("updateAnalysisTab"):"popupDocumentTab"===o.id&&t.publish("updateDocumentsTab"),t.publish("popupTabChanged")},d._vm.prevFeature=function(e,a){require(["mapui"],function(e){var a=e.getMap();a.infoWindow.selectPrevious(),t.publish("updateCustomInfoWindow")})},d._vm.nextFeature=function(e,a){require(["mapui"],function(e){var a=e.getMap();a.infoWindow.selectNext(),t.publish("updateCustomInfoWindow")})},d._vm.selectAnalysisType=function(e,a){require(["mapui","atlas/tools/Results","esri/tasks/query","esri/tasks/QueryTask"],function(o,s,t,r){var l=a.target?a.target:a.srcElement,n=l.value,b=o.getMap().infoWindow,i=b.getSelectedFeature(),v={},u=l.options[l.selectedIndex];if(n===e.restorationModuleType()&&(v={rasterId:u.getAttribute("data-id")}),e.currentAnalysisType(n),i.attributes.OBJECTID){var m=i.attributes.OBJECTID,p=i._layer,c=p._url.path,d=new r(c),_=new t;_.objectIds=[m],_.outFields=["*"],_.returnGeometry=!0,_.maxAllowableOffset=0,d.execute(_,function(e){e.features.length>0?s.getResultsForType(n,e.features[0],v):s.getResultsForType(n,i,v)})}else s.getResultsForType(n,i,v)})},d._vm.selectSlopeAmount=function(e,a){require(["mapui","atlas/tools/Results"],function(a,o){var s=a.getMap().infoWindow,t=s.getSelectedFeature(),r=document.querySelector(".analysis-options-select"),l=r.options[r.selectedIndex],n={index:+l.getAttribute("data-option")};o.getResultsForType(e.currentAnalysisType(),t,n)})},d._vm.landsatYearChanged=function(e,a){var o=document.getElementById("landsat-checkbox");o.checked&&t.publish("updateLandsatLayer")},d._vm.canopyDensityClicked=function(){require(["atlas/tools/TreeCoverDensityDialog"],function(e){e.show()})},d._vm.treeCoverDialogClose=function(){require(["atlas/tools/TreeCoverDensityDialog"],function(e){e.hide()})},o.applyBindings(d._vm,document.body)})}});return d.getDataModel=function(){return d._dataModel},d.getVM=function(){return d._vm},d.initialize=function(e,a){return d._created?d._update(e,a):d._instance=new d(e,a),d._instance},d.destroy=function(){delete d._instance},d});