define(["declare","mainmodel","ko","dom","topic","toolsconfig","memory","number","array","root/languages","query","attr","toolsevents","root/analysis/ethiopiaConfig","root/analysis/constants","root/analysis/analysisConfig"],function(e,a,o,s,t,r,l,n,b,i,v,u,m,p,c,d){var _=e(null,{constructor:function(e,s){r.getConfig();_._vm={},_._dataModel={},require(["toolsevents"],function(e){var s=a.getVM(),r=s.currentLanguage(),l=app.config.appLanguages[r].title,n=app.config.appLanguages[r].flagTitle,b=i[r],v=e.getEvents();_._vm.tabBasemapTitle=o.observable(b.tabBasemapTitle),_._vm.tabLegendTitle=o.observable(b.tabLegendTitle),_._vm.tabLayersTitle=o.observable(b.tabLayersTitle),_._vm.buttonLayersText=o.observable(b.buttonLayersText),_._vm.closeButtonText=o.observable(b.closeButtonText),_._vm.title=o.observable(l),_._vm.flagTitle=o.observable(n),_._vm.printDialog=o.observable(b.printDialog),_._vm.layersDrawingOption=o.observable([]),_._vm.about=o.observable(b.about),_._vm.downloadData=o.observable(b.downloadData),_._vm.sources=o.observable(b.sources),_._vm.print=o.observable(b.print),_._vm.legislativeText=o.observable(b.legislativeText),_._vm.printReport=o.observable(b.printReport),_._vm.clickPrintReport=function(e,a){t.publish(v.printReport,e,a)},_._vm.zoom=o.observable(b.zoom),_._vm.selectAll=o.observable(b.selectAll),_._vm.clearAll=o.observable(b.clearAll),_._vm.transparency=o.observable(b.transparency),_._vm.basemapTitles=o.observable(b.basemapTitles),_._vm.editingEnabled=o.observable(!1),_._vm.editingFeatureEnabled=o.observable(!1),_._vm.addFeatureEnabled=o.observable(!1),_._vm.currentLayerId=o.observable(""),_._vm.currentEditableGraphic=o.observable({}),_._vm.originalEditableGraphic=o.observable({}),_._vm.aboutLink=o.observable(app.config.aboutLinkUrl),_._vm.downloadLink=o.observable(app.config.downloadDataUrl),_._vm.mapThemes=o.observableArray("en"===r?app.config.mapThemes:app.config.mapThemesAlternate),_._vm.showMapThemes=o.observable(!1),_._vm.mapThemesLabel=o.observable(b.mapThemesLabel),_._vm.basemapGalleryVisible=o.observable(!1),_._vm.analyzeToolsVisible=o.observable(!1),_._vm.shareToolsVisible=o.observable(!1),_._vm.showUploadTools=o.observable(!1),_._vm.resotrationModule=o.observable(!0),_._vm.restorationModuleType=o.observable("restoration"),_._vm.resotrationModuleOptions=o.observableArray(p.options),_._vm.slopeAmountOptions=o.observableArray(d[c.SLOPE_BREAKDOWN].slopeOptions),_._vm.slopeSelectDescription=o.observable("Choose how much slope to analyze:"),_._vm.slopeActiveOption=o.observable(d[c.SLOPE_BREAKDOWN].slopeOptions[0]),_._vm.forestLossYears=o.observableArray(["2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013"]),_._vm.clearanceAlertBounds=o.observable(),_._vm.clearanceAlertLabels=o.observable(),_._vm.popupDataTab=o.observable(b.popupDataTab),_._vm.popupAnalysisTab=o.observable(b.popupAnalysisTab),_._vm.popupDocumentTab=o.observable(b.popupDocumentTab),_._vm.popupActiveTab=o.observable("popupDataTab"),_._vm.popupIndex=o.observable(0),_._vm.popupCount=o.observable(0),_._vm.analysisLoss=o.observable(b.analysisLoss),_._vm.analysisLC=o.observable(b.analysisLC),_._vm.analysisGain=o.observable(b.analysisGain),_._vm.analysisIFL=o.observable(b.analysisIFL),_._vm.analysisCS=o.observable(b.analysisCS),_._vm.analysisFire=o.observable(b.analysisFire),_._vm.analysisLCComposition=o.observable(b.analysisLCComposition),_._vm.analysisOptions=o.observableArray(b.analysisOptions),_._vm.firesOneWeek=o.observable(b.firesOneWeek),_._vm.fires72Hours=o.observable(b.fires72Hours),_._vm.fires48Hours=o.observable(b.fires48Hours),_._vm.fires24Hours=o.observable(b.fires24Hours),_._vm.lossStartingYear=o.observable(b.lossStartingYear),_._vm.lossEndingYear=o.observable(b.lossEndingYear),_._vm.accordionForestCoverTitle=o.observable(b.accordionForestCoverTitle),_._vm.accordionForestLossTitle=o.observable(b.accordionForestLossTitle),_._vm.accordionLandUseTitle=o.observable(b.accordionLandUseTitle),_._vm.treeCoverAnalysis=o.observable(b.treeCoverAnalysis),_._vm.otherAnalysisTypes=o.observable(b.otherAnalysisTypes),_._vm.forestCoverLossLabel=o.observable(b.forestCoverLossLabel),_._vm.activeFiresLabel=o.observable(b.activeFiresLabel),_._vm.treeCoverDensityLabel=o.observable(b.treeCoverDensityLabel),_._vm.landCoverLabel=o.observable(b.landCoverLabel),_._vm.treeCoverGainLabel=o.observable(b.treeCoverGainLabel),_._vm.carbonLayerLabel=o.observable(b.carbonLayerLabel),_._vm.intactForestLayerLabel=o.observable(b.intactForestLayerLabel),_._vm.uploadInstructions=o.observableArray(b.uploadInstructions),_._vm.drawButtonText=o.observable(b.drawButtonText),_._vm.uploadButtonText=o.observable(b.uploadButtonText),_._vm.currentAnalysisType=o.observable(b.analysisLoss),_._vm.clearAllFeatures=o.observable(b.clearAllFeatures),_._vm.deleteCustomFeature=o.observable(b.deleteCustomFeature),_._vm.landsatTextLabel=o.observable(b.landsatTextLabel),_._vm.tcdSelectorBegin=o.observable(b.tcdSelectorBegin),_._vm.tcdSelectorEnd=o.observable(b.tcdSelectorEnd),_._vm.treeCoverSliderLabel=o.observable(b.treeCoverSliderLabel),_._vm.tcdSelectorValue=o.observable(30),_._vm.landsatOptions=o.observableArray([2013,2012,2011,2010,2009,2008,2007,2006,2005,2004,2003,2002,2001,2e3]),_._vm.selectedLandsatYear=o.observable(2013),_._vm.customFeatureShowing=o.observable(!1),_._vm.featureDocuments=o.observableArray([]),_._vm.documentsUnavailable=o.observable(b.documentsUnavailable),_._vm.documentType=o.observable(b.documentType),_._vm.documentAuthor=o.observable(b.documentAuthor),_._vm.documentDate=o.observable(b.documentDate),_._vm.documentLink=o.observable(b.documentLink),_._vm.changePopupTabs=function(e,a){var o=a.target?a.target:a.srcElement;e.popupActiveTab(o.id),"popupAnalysisTab"===o.id?t.publish("updateAnalysisTab"):"popupDocumentTab"===o.id&&t.publish("updateDocumentsTab"),t.publish("popupTabChanged")},_._vm.prevFeature=function(e,a){require(["mapui"],function(e){var a=e.getMap();a.infoWindow.selectPrevious(),t.publish("updateCustomInfoWindow")})},_._vm.nextFeature=function(e,a){require(["mapui"],function(e){var a=e.getMap();a.infoWindow.selectNext(),t.publish("updateCustomInfoWindow")})},_._vm.selectAnalysisType=function(e,a){require(["mapui","atlas/tools/Results","esri/tasks/query","esri/tasks/QueryTask"],function(o,s,t,r){var l=a.target?a.target:a.srcElement,n=l.value,b=o.getMap().infoWindow,i=b.getSelectedFeature(),v={},u=l.options[l.selectedIndex];if(n===e.restorationModuleType()&&(v={index:+u.getAttribute("data-option")}),e.currentAnalysisType(n),i.attributes.OBJECTID){var m=i.attributes.OBJECTID,p=i._layer,c=p._url.path,d=new r(c),_=new t;_.objectIds=[m],_.outFields=["*"],_.returnGeometry=!0,_.maxAllowableOffset=0,d.execute(_,function(e){e.features.length>0?s.getResultsForType(n,e.features[0],v):s.getResultsForType(n,i,v)})}else s.getResultsForType(n,i,v)})},_._vm.selectSlopeAmount=function(e,a){require(["mapui","atlas/tools/Results"],function(a,o){var s=a.getMap().infoWindow,t=s.getSelectedFeature(),r=document.querySelector(".analysis-options-select"),l=r.options[r.selectedIndex],n={index:+l.getAttribute("data-option")};o.getResultsForType(e.currentAnalysisType(),t,n)})},_._vm.landsatYearChanged=function(e,a){var o=document.getElementById("landsat-checkbox");o.checked&&t.publish("updateLandsatLayer")},_._vm.canopyDensityClicked=function(){require(["atlas/tools/TreeCoverDensityDialog"],function(e){e.show()})},_._vm.treeCoverDialogClose=function(){require(["atlas/tools/TreeCoverDensityDialog"],function(e){e.hide()})},o.applyBindings(_._vm,document.body)})}});return _.getDataModel=function(){return _._dataModel},_.getVM=function(){return _._vm},_.initialize=function(e,a){return _._created?_._update(e,a):_._instance=new _(e,a),_._instance},_.destroy=function(){delete _._instance},_});