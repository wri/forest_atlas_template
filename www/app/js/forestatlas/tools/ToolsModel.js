define(["declare","mainmodel","ko","dom","topic","toolsconfig","memory","number","array","root/languages","query","attr","toolsevents","root/analysis/ethiopiaConfig"],function(e,a,o,s,r,t,l,b,n,v,i,m,u,p){var c=e(null,{constructor:function(e,s){t.getConfig();c._vm={},c._dataModel={},require(["toolsevents"],function(e){var s=a.getVM(),t=s.currentLanguage(),l=app.config.appLanguages[t].title,b=app.config.appLanguages[t].flagTitle,n=v[t],i=e.getEvents();c._vm.tabBasemapTitle=o.observable(n.tabBasemapTitle),c._vm.tabLegendTitle=o.observable(n.tabLegendTitle),c._vm.tabLayersTitle=o.observable(n.tabLayersTitle),c._vm.buttonLayersText=o.observable(n.buttonLayersText),c._vm.closeButtonText=o.observable(n.closeButtonText),c._vm.title=o.observable(l),c._vm.flagTitle=o.observable(b),c._vm.printDialog=o.observable(n.printDialog),c._vm.layersDrawingOption=o.observable([]),c._vm.about=o.observable(n.about),c._vm.downloadData=o.observable(n.downloadData),c._vm.sources=o.observable(n.sources),c._vm.print=o.observable(n.print),c._vm.legislativeText=o.observable(n.legislativeText),c._vm.printReport=o.observable(n.printReport),c._vm.clickPrintReport=function(e,a){r.publish(i.printReport,e,a)},c._vm.zoom=o.observable(n.zoom),c._vm.selectAll=o.observable(n.selectAll),c._vm.clearAll=o.observable(n.clearAll),c._vm.transparency=o.observable(n.transparency),c._vm.basemapTitles=o.observable(n.basemapTitles),c._vm.editingEnabled=o.observable(!1),c._vm.editingFeatureEnabled=o.observable(!1),c._vm.addFeatureEnabled=o.observable(!1),c._vm.currentLayerId=o.observable(""),c._vm.currentEditableGraphic=o.observable({}),c._vm.originalEditableGraphic=o.observable({}),c._vm.aboutLink=o.observable(app.config.aboutLinkUrl),c._vm.downloadLink=o.observable(app.config.downloadDataUrl),c._vm.mapThemes=o.observableArray("en"===t?app.config.mapThemes:app.config.mapThemesAlternate),c._vm.showMapThemes=o.observable(!1),c._vm.mapThemesLabel=o.observable(n.mapThemesLabel),c._vm.basemapGalleryVisible=o.observable(!1),c._vm.analyzeToolsVisible=o.observable(!1),c._vm.shareToolsVisible=o.observable(!1),c._vm.showUploadTools=o.observable(!1),c._vm.resotrationModule=o.observable(!0),c._vm.restorationModuleType=o.observable("restoration"),c._vm.resotrationModuleOptions=o.observableArray(p.options),c._vm.forestLossYears=o.observableArray(["2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013"]),c._vm.clearanceAlertBounds=o.observable(),c._vm.clearanceAlertLabels=o.observable(),c._vm.popupDataTab=o.observable(n.popupDataTab),c._vm.popupAnalysisTab=o.observable(n.popupAnalysisTab),c._vm.popupDocumentTab=o.observable(n.popupDocumentTab),c._vm.popupActiveTab=o.observable("popupDataTab"),c._vm.popupIndex=o.observable(0),c._vm.popupCount=o.observable(0),c._vm.analysisLoss=o.observable(n.analysisLoss),c._vm.analysisLC=o.observable(n.analysisLC),c._vm.analysisGain=o.observable(n.analysisGain),c._vm.analysisIFL=o.observable(n.analysisIFL),c._vm.analysisCS=o.observable(n.analysisCS),c._vm.analysisFire=o.observable(n.analysisFire),c._vm.analysisLCComposition=o.observable(n.analysisLCComposition),c._vm.analysisOptions=o.observableArray(n.analysisOptions),c._vm.firesOneWeek=o.observable(n.firesOneWeek),c._vm.fires72Hours=o.observable(n.fires72Hours),c._vm.fires48Hours=o.observable(n.fires48Hours),c._vm.fires24Hours=o.observable(n.fires24Hours),c._vm.lossStartingYear=o.observable(n.lossStartingYear),c._vm.lossEndingYear=o.observable(n.lossEndingYear),c._vm.accordionForestCoverTitle=o.observable(n.accordionForestCoverTitle),c._vm.accordionForestLossTitle=o.observable(n.accordionForestLossTitle),c._vm.accordionLandUseTitle=o.observable(n.accordionLandUseTitle),c._vm.treeCoverAnalysis=o.observable(n.treeCoverAnalysis),c._vm.otherAnalysisTypes=o.observable(n.otherAnalysisTypes),c._vm.forestCoverLossLabel=o.observable(n.forestCoverLossLabel),c._vm.activeFiresLabel=o.observable(n.activeFiresLabel),c._vm.treeCoverDensityLabel=o.observable(n.treeCoverDensityLabel),c._vm.landCoverLabel=o.observable(n.landCoverLabel),c._vm.treeCoverGainLabel=o.observable(n.treeCoverGainLabel),c._vm.carbonLayerLabel=o.observable(n.carbonLayerLabel),c._vm.intactForestLayerLabel=o.observable(n.intactForestLayerLabel),c._vm.uploadInstructions=o.observableArray(n.uploadInstructions),c._vm.drawButtonText=o.observable(n.drawButtonText),c._vm.uploadButtonText=o.observable(n.uploadButtonText),c._vm.currentAnalysisType=o.observable(n.analysisLoss),c._vm.clearAllFeatures=o.observable(n.clearAllFeatures),c._vm.deleteCustomFeature=o.observable(n.deleteCustomFeature),c._vm.landsatTextLabel=o.observable(n.landsatTextLabel),c._vm.tcdSelectorBegin=o.observable(n.tcdSelectorBegin),c._vm.tcdSelectorEnd=o.observable(n.tcdSelectorEnd),c._vm.treeCoverSliderLabel=o.observable(n.treeCoverSliderLabel),c._vm.tcdSelectorValue=o.observable(30),c._vm.landsatOptions=o.observableArray([2013,2012,2011,2010,2009,2008,2007,2006,2005,2004,2003,2002,2001,2e3]),c._vm.selectedLandsatYear=o.observable(2013),c._vm.customFeatureShowing=o.observable(!1),c._vm.featureDocuments=o.observableArray([]),c._vm.documentsUnavailable=o.observable(n.documentsUnavailable),c._vm.documentType=o.observable(n.documentType),c._vm.documentAuthor=o.observable(n.documentAuthor),c._vm.documentDate=o.observable(n.documentDate),c._vm.documentLink=o.observable(n.documentLink),c._vm.changePopupTabs=function(e,a){var o=a.target?a.target:a.srcElement;e.popupActiveTab(o.id),"popupAnalysisTab"===o.id?r.publish("updateAnalysisTab"):"popupDocumentTab"===o.id&&r.publish("updateDocumentsTab"),r.publish("popupTabChanged")},c._vm.prevFeature=function(e,a){require(["mapui"],function(e){var a=e.getMap();a.infoWindow.selectPrevious(),r.publish("updateCustomInfoWindow")})},c._vm.nextFeature=function(e,a){require(["mapui"],function(e){var a=e.getMap();a.infoWindow.selectNext(),r.publish("updateCustomInfoWindow")})},c._vm.selectAnalysisType=function(e,a){require(["mapui","atlas/tools/Results","esri/tasks/query","esri/tasks/QueryTask"],function(o,s,r,t){var l=a.target?a.target:a.srcElement,b=l.value,n=o.getMap().infoWindow,v=n.getSelectedFeature(),i={},m=l.options[l.selectedIndex];if(b===e.restorationModuleType()&&(i={index:+m.getAttribute("data-option")}),e.currentAnalysisType(b),v.attributes.OBJECTID){var u=v.attributes.OBJECTID,p=v._layer,c=p._url.path,d=new t(c),_=new r;_.objectIds=[u],_.outFields=["*"],_.returnGeometry=!0,_.maxAllowableOffset=0,d.execute(_,function(e){e.features.length>0?s.getResultsForType(b,e.features[0],i):s.getResultsForType(b,v,i)})}else s.getResultsForType(b,v,i)})},c._vm.landsatYearChanged=function(e,a){var o=document.getElementById("landsat-checkbox");o.checked&&r.publish("updateLandsatLayer")},c._vm.canopyDensityClicked=function(){require(["atlas/tools/TreeCoverDensityDialog"],function(e){e.show()})},c._vm.treeCoverDialogClose=function(){require(["atlas/tools/TreeCoverDensityDialog"],function(e){e.hide()})},o.applyBindings(c._vm,document.body)})}});return c.getDataModel=function(){return c._dataModel},c.getVM=function(){return c._vm},c.initialize=function(e,a){return c._created?c._update(e,a):c._instance=new c(e,a),c._instance},c.destroy=function(){delete c._instance},c});