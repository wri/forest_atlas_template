define(["toolsmodel","toolsconfig","esri/urlUtils","dojo/_base/lang"],function(t,e,n,r){"use strict";e.initialize();var s=e.getConfig().analysisConfig,i=t.getVM(),u=function(){var t=n.urlToObject(location.href),e=t&&t.query&&t.query.tcd;return e?parseInt(e):30},a={getArithmeticRuleWithDensity:function(t,e){var n=s.lossGainWithDensityRasterFunction;return n.rasterFunctionArguments.Raster2=t,n.rasterFunctionArguments.Raster.rasterFunctionArguments.InputRanges=e,JSON.stringify(n)},getCurrentDensityRange:function(){var t=i?i.tcdSelectorValue():u();return[0,t,t,101]},addRenderingRuleToDensity:function(t){var e=r.clone(s.treeCoverDensityRule),n=s.treeDensity.rasterId,i=this.getCurrentDensityRange();return e.rasterFunctionArguments.Raster.rasterFunctionArguments.Raster=n,e.rasterFunctionArguments.Raster.rasterFunctionArguments.InputRanges=i,e.rasterFunctionArguments.Raster2=JSON.parse(t),e.rasterFunctionArguments.Raster2.outputPixelType="U8",JSON.stringify(e)}};return a});